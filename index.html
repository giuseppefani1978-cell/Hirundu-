<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Jeu Salento - Aracne et Tarantula</title>
  <style>
    body { margin: 0; background: #222; color: white; font-family: sans-serif; }
    #gameCanvas { display: none; background: #000; width: 100%; height: 100vh; }
    #hud { display: none; position: absolute; top: 10px; left: 10px; font-size: 20px; }
    #controls { 
      display: none; position: absolute; bottom: 20px; left: 50%; 
      transform: translateX(-50%); 
    }
    .btn {
      width: 60px; height: 60px; background: rgba(255,255,255,0.3);
      border-radius: 50%; text-align: center; line-height: 60px; font-size: 30px;
      margin: 5px; user-select: none;
    }
    #startScreen { 
      display: flex; justify-content: center; align-items: center; 
      flex-direction: column; height: 100vh; background: #333; color: white; 
    }
    #tarantulaBox {
      display: none; position: absolute; bottom: 120px; left: 50%; transform: translateX(-50%);
      background: rgba(0,0,0,0.8); border: 2px solid #fff; padding: 10px; border-radius: 10px;
      max-width: 300px; text-align: center; font-size: 16px;
    }
  </style>
</head>
<body>
  <div id="startScreen">
    <h1>üåç Jeu du Salento</h1>
    <p>Avec Aracne üê¶ et Tarantula üï∑Ô∏è</p>
    <button onclick="startGame()">D√©marrer le jeu</button>
  </div>

  <canvas id="gameCanvas"></canvas>
  <div id="hud">‚≠ê 0 / 10</div>
  <div id="tarantulaBox">Texte de Tarantula</div>

  <div id="controls">
    <div style="display:flex; justify-content:center;">
      <div class="btn" ontouchstart="move('up')">‚¨ÜÔ∏è</div>
    </div>
    <div style="display:flex; justify-content:center;">
      <div class="btn" ontouchstart="move('left')">‚¨ÖÔ∏è</div>
      <div class="btn" ontouchstart="move('down')">‚¨áÔ∏è</div>
      <div class="btn" ontouchstart="move('right')">‚û°Ô∏è</div>
    </div>
  </div>

  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");
    const hud = document.getElementById("hud");
    const tarantulaBox = document.getElementById("tarantulaBox");

    let w, h;
    function resize() {
      w = window.innerWidth;
      h = window.innerHeight;
      canvas.width = w;
      canvas.height = h;
    }
    window.onresize = resize;

    // Images
    const mapImg = new Image();
    mapImg.src = "assets/salento-map.jpg";

    const aracneImg = new Image();
    aracneImg.src = "assets/hirundu.png"; // anciennement Hirundu, maintenant Aracne üê¶

    const tarantulaImg = new Image();
    tarantulaImg.src = "assets/aracne.png"; // anciennement Arachne, maintenant Tarantula üï∑Ô∏è

    // Joueur (Aracne)
    let aracne = { x: 200, y: 200, size: 40, speed: 5 };

    // Points d‚Äôint√©r√™t avec √©toiles
    const POIS = [
      {name: "Otranto",        x: 0.85, y: 0.25, info: "Cath√©drale d‚ÄôOtranto et ses mosa√Øques."},
      {name: "Porto Badisco",  x: 0.9,  y: 0.3,  info: "Superbe calanque."},
      {name: "Santa Cesarea",  x: 0.88, y: 0.35, info: "Station thermale r√©put√©e."},
      {name: "Castro",         x: 0.87, y: 0.4,  info: "Temple d‚ÄôAth√©na selon la l√©gende."},
      {name: "Il Ciolo",       x: 0.9,  y: 0.45, info: "Calanque c√©l√®bre avec pont routier."},
      {name: "Santa Maria di Leuca", x: 0.85, y: 0.55, info: "Phare et cascade aux confins des Pouilles."},
      {name: "Gallipoli",      x: 0.5,  y: 0.35, info: "Ville sur la mer Ionienne."},
      {name: "Porto Cesareo",  x: 0.4,  y: 0.25, info: "Plages magnifiques."},
      {name: "Nard√≤",          x: 0.45, y: 0.3,  info: "Ville baroque."},
      {name: "Lecce",          x: 0.6,  y: 0.15, info: "Florence du Sud."}
    ];
    let collected = 0;

    function startGame() {
      document.getElementById("startScreen").style.display = "none";
      canvas.style.display = "block";
      hud.style.display = "block";
      document.getElementById("controls").style.display = "block";
      resize();
      running = true;
      requestAnimationFrame(loop);
    }

    function move(dir) {
      if (dir === "up") aracne.y -= aracne.speed;
      if (dir === "down") aracne.y += aracne.speed;
      if (dir === "left") aracne.x -= aracne.speed;
      if (dir === "right") aracne.x += aracne.speed;
    }

    function loop() {
      if (!running) return;
      draw();
      requestAnimationFrame(loop);
    }

    function draw() {
      ctx.clearRect(0, 0, w, h);
      ctx.drawImage(mapImg, 0, 0, w, h);

      // √âtoiles
      POIS.forEach(p => {
        if (!p.collected) {
          const px = p.x * w;
          const py = p.y * h;
          ctx.fillStyle = "gold";
          ctx.beginPath();
          ctx.arc(px, py, 10, 0, Math.PI*2);
          ctx.fill();
        }
      });

      // Joueur (Aracne)
      ctx.drawImage(aracneImg, aracne.x, aracne.y, aracne.size, aracne.size);

      // Collision avec √©toiles
      POIS.forEach(p => {
        if (!p.collected) {
          const px = p.x * w, py = p.y * h;
          if (Math.hypot(aracne.x - px, aracne.y - py) < 30) {
            p.collected = true;
            collected++;
            hud.innerText = `‚≠ê ${collected} / 10`;
            showTarantula(p.info);
          }
        }
      });
    }

    function showTarantula(text) {
      tarantulaBox.innerText = "üï∑Ô∏è Tarantula : " + text;
      tarantulaBox.style.display = "block";
      setTimeout(()=>{ tarantulaBox.style.display="none"; }, 4000);
    }

    let running = false;
  </script>
</body>
</html>
